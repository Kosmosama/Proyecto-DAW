<div class="battle-container">
  @if(battleService.isBattleOver()) {
  <h2>Â¡Batalla terminada!</h2>
  @if(battleService.winner() === 'player') {
  <p>Â¡Ganaste! ðŸŽ‰</p>
  }
  @if(battleService.winner() === 'enemy') {
  <p>Perdiste... ðŸ˜¢</p>
  }
  }

  @if(!battleService.isBattleOver()) {
  <h2>Turno {{ battleService.turn() }}</h2>

  <section class="teams">
    <div class="team player-team">
      <h3>Tu equipo</h3>
      <ul>
        @for(state of playerBattleStates(); track $index) {
        <li (click)="switchTo($index)" [class.active]="$index === battleService.getPlayerActiveIndex()"
          [class.fainted]="state.fainted">
          {{ state.pokemon.species }} (HP: {{ state.currentHP }}/{{ state.maxHP }})
        </li>
        }
      </ul>
      <p>
        <strong>Activo:</strong> {{ playerActive()?.pokemon!.species }}
      </p>
    </div>

    <div class="team enemy-team">
      <h3>Equipo enemigo</h3>
      <ul>
        @for(state of enemyBattleStates(); track $index) {
        <li [class.active]="$index === battleService.getEnemyActiveIndex()" [class.fainted]="state.fainted">
          {{ state.pokemon.species }} (HP: {{ state.currentHP }}/{{ state.maxHP }})
        </li>
        }
      </ul>
      <p>
        <strong>Activo enemigo:</strong> {{ enemyActive()?.pokemon!.species }}
      </p>
    </div>
  </section>

  <section class="actions">
    <h3>Elige un movimiento</h3>
    @if(playerActive()) {
    <div class="moves">
      @for(move of playerActive()!.pokemon.moves; track $index) {
      <button (click)="doTurn(move)" [disabled]="battleService.isBattleOver()">
        {{ move }}
      </button>
      }
    </div>
    }
  </section>

  <section class="log">
    <h3>Registro de batalla</h3>
    <ul>
      @for(logEntry of battleService.battleLog(); track $index) {
      <li>{{ logEntry }}</li>
      }
    </ul>
  </section>
  }
</div>